addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 2,
popup = ~content) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
head(leaflet_debt)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)") %>%
addMarkers(label = leaflet_debt$State)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)") %>%
addMarkers(map = leaflet_debt, label = leaflet_debt$State)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)") %>%
addMarkers(leaflet_debt, label = leaflet_debt$State)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)") %>%
addMarkers(map = leaflet_debt$geometry, label = leaflet_debt$State)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)") %>%
addMarkers(leaflet_debt$geometry, label = leaflet_debt$State)
content <- paste("State", leaflet_debt$State, "<br/>",
"Debt Level", leaflet_debt$Debt_Level, "<br/>",)
content <- paste("State:", leaflet_debt$State, sep = " ", "br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
content <- paste("State:", leaflet_debt$State,  <"br/>",
content <- paste("State:", leaflet_debt$State,  <"br/>",
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
library(rvest)
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating.html")
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
View(credit)
web %>%
html_nodes("*") %>%
html_name() %>%
unique()
credit %>%
html_nodes("*") %>%
html_name() %>%
unique()
credit_scores <- credit %>%
html_nodes("table")
View(credit_scores)
credit_scores
credit_scores <- credit %>%
html_nodes("table") %>%
html_table(fill = TRUE)
credit_scores
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores
credit_scores <- credit_scores %>%
select(State, '2020')
View(credit_scores)
View(credit)
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit %>%
html_nodes("*") %>%
html_name() %>%
unique()
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores
credit_scores <- credit_scores %>%
select(State, '2020')
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit %>%
html_nodes("*") %>%
html_name() %>%
unique()
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores
credit_scores <- credit_scores %>%
select(State, '2020')
credit_scores <- credit_scores %>%
select(State, '2020')
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit %>%
html_nodes("*") %>%
html_name() %>%
unique()
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores
credit_scores <- credit_scores %>%
select(State, '2020')
View(credit_scores)
credit_scores <- credit_scores %>%
select(State, '2020') %>%
filter(State != "Source:[2]")
View(state_debt)
credit_scores <- credit_scores %>%
select(State, '2020') %>%
filter(State != "Source:[2]") %>%
rename(Credit_Rating = "2020")
state_debt <- left_join(state_debt, credit_scores, by = "State")
rm(list=ls())
# Normal Choroplath libs
library(tidyverse)
library(dplyr)
library(urbnmapr)
library(tmap)
library(sf)
library(stringr)
# Leaflet libs
#dplyr
library(leaflet)
library(tigris)
#webscrapping
library(rvest)
data <- read.csv("state_2020.csv")
data_1 <- data %>%
select(State, Debt.Ratio..Total.Debts.Total.Assets) %>%
rename("Debt_Level" = "Debt.Ratio..Total.Debts.Total.Assets")
#Debt was recorded as a character, converted to numeric
data_1$Debt_Level <- str_remove_all(string = data_1$Debt_Level, pattern = "%")
data_1$Debt_Level <- as.numeric(data_1$Debt_Level)
# removing DC as it is a district
states_sf <- get_urbn_map("states", sf = TRUE)
states_sf <- states_sf %>%
filter(state_abbv != "DC")
# Debt levels by state
states_sf <- states_sf %>%
rename(State = "state_name")
state_debt <- left_join(data_1, states_sf, by = "State")
head(state_debt)
state_debt <- st_as_sf(state_debt)
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,250,300,350,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
# webscraping credit ratings of each state from wikipedia after I did my public service of updating their 2020 credit ratings since I have access to it
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit %>%
html_nodes("*") %>%
html_name() %>%
unique()
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores
credit_scores <- credit_scores %>%
select(State, '2020') %>%
filter(State != "Source:[2]") %>%
rename(Credit_Rating = "2020")
state_debt <- left_join(state_debt, credit_scores, by = "State")
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>"
"Credit Rating:", leaflet_debt$Credit_Rating)
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating)
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
US <- geocode("USA", source = "google")
head(US)
head(leaflet_debt)
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating)
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
rm(list=ls())
# Normal Choroplath libs
library(tidyverse)
library(dplyr)
library(urbnmapr)
library(tmap)
library(sf)
library(stringr)
# Leaflet libs
#dplyr
library(leaflet)
library(tigris)
#webscrapping
library(rvest)
data <- read.csv("state_2020.csv")
data_1 <- data %>%
select(State, Debt.Ratio..Total.Debts.Total.Assets) %>%
rename("Debt_Level" = "Debt.Ratio..Total.Debts.Total.Assets")
#Debt was recorded as a character, converted to numeric
data_1$Debt_Level <- str_remove_all(string = data_1$Debt_Level, pattern = "%")
data_1$Debt_Level <- as.numeric(data_1$Debt_Level)
# removing DC as it is a district
states_sf <- get_urbn_map("states", sf = TRUE)
states_sf <- states_sf %>%
filter(state_abbv != "DC")
states_sf <- states_sf %>%
rename(State = "state_name")
state_debt <- left_join(data_1, states_sf, by = "State")
head(state_debt)
state_debt <- st_as_sf(state_debt)
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,250,300,350,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit %>%
html_nodes("*") %>%
html_name() %>%
unique()
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores <- credit_scores %>%
select(State, '2020') %>%
filter(State != "Source:[2]") %>%
rename(Credit_Rating = "2020")
state_debt <- left_join(data_1, credit_scores, by = "State")
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating)
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
View(data_1)
rm(list=ls())
# Normal Choroplath libs
library(tidyverse)
library(dplyr)
library(urbnmapr)
library(tmap)
library(sf)
library(stringr)
# Leaflet libs
#dplyr
library(leaflet)
library(tigris)
#webscrapping
library(rvest)
data <- read.csv("state_2020.csv")
data_1 <- data %>%
select(State, Debt.Ratio..Total.Debts.Total.Assets) %>%
rename("Debt_Level" = "Debt.Ratio..Total.Debts.Total.Assets")
#Debt was recorded as a character, converted to numeric
data_1$Debt_Level <- str_remove_all(string = data_1$Debt_Level, pattern = "%")
data_1$Debt_Level <- as.numeric(data_1$Debt_Level)
# removing DC as it is a district
states_sf <- get_urbn_map("states", sf = TRUE)
states_sf <- states_sf %>%
filter(state_abbv != "DC")
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating, "<br/>")
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
rm(list=ls())
# Normal Choroplath libs
library(tidyverse)
library(dplyr)
library(urbnmapr)
library(tmap)
library(sf)
library(stringr)
# Leaflet libs
#dplyr
library(leaflet)
library(tigris)
#webscrapping
library(rvest)
data <- read.csv("state_2020.csv")
data_1 <- data %>%
select(State, Debt.Ratio..Total.Debts.Total.Assets) %>%
rename("Debt_Level" = "Debt.Ratio..Total.Debts.Total.Assets")
#Debt was recorded as a character, converted to numeric
data_1$Debt_Level <- str_remove_all(string = data_1$Debt_Level, pattern = "%")
data_1$Debt_Level <- as.numeric(data_1$Debt_Level)
# removing DC as it is a district
states_sf <- get_urbn_map("states", sf = TRUE)
states_sf <- states_sf %>%
filter(state_abbv != "DC")
states_sf <- states_sf %>%
rename(State = "state_name")
state_debt <- left_join(data_1, states_sf, by = "State")
head(state_debt)
state_debt <- st_as_sf(state_debt)
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,250,300,350,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores <- credit_scores %>%
select(State, '2020') %>%
filter(State != "Source:[2]") %>%
rename(Credit_Rating = "2020")
data_1 <- left_join(data_1, credit_scores, by = "State")
View(data_1)
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating, "<br/>")
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
