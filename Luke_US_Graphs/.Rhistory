head(UA_1, 10)
state.77 <- as.data.frame(state.x77)
state.77 <- tibble::rownames_to_column(state.77, "X")
UA_1.2 <- left_join(UA_1, state.77, by = "X")
UA_1.2 <- cbind(UA_1.2,state.division)
UA_1.2 <- cbind(UA_1.2, state.region)
UA_1.2 <- UA_1.2 %>%
rename(State.Division = "state.division", State.Region = "state.region", State = "X", Murder = "Murder.x")
head(UA_1.2, 10)
UA_avg <- UA_1.2 %>%
select(-c("State","State.Division", "State.Region"))
UA_avg <- colMeans(UA_avg)
head(UA_avg, 10)
UA_avg
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division"))
colMeans(UA_region)
?summarise_each
?summarise_at
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division")) %>%
summarise_if(is.numeric(), funs(mean))
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division")) %>%
summarise_at(funs(mean))
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division")) %>%
summarise_each(funs(mean))
UA_region
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division")) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Violent_crime))
UA_region
rm(list=ls())
library(dplyr)
library (rvest)
web <- read_html("http://vincentarelbundock.github.io/Rdatasets/datasets.html")
web %>%
html_nodes("*") %>%
html_name() %>%
unique()
table <- web %>%
html_nodes ("table")
table_1 <- web %>%
html_nodes("table") %>%
.[[2]] %>%
html_table(fill = TRUE)
table_df <- as.data.frame(table_1) %>%
select("Package", "Item", "Title", "Rows", "Cols")
head(table_df, 5)
link <- "https://vincentarelbundock.github.io/Rdatasets/csv"
.csv <- ".csv"
check <- paste(link, table_df$Package, table_df$Item, sep = "/")
CSV_Links <-paste(check, .csv, sep = "")
table_df <- table_df %>%
mutate(CSV_Links)
head(table_df, 5)
title <- table_df %>%
filter(Title == "Violent Crime Rates by US State")
title
UA <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/datasets/USArrests.csv")
head(UA)
UA_1 <- UA %>%
mutate(sum(Murder, Assault, Rape)) %>%
rename(Violent_Crime = "sum(Murder, Assault, Rape)")
head(UA_1, 10)
UA <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/datasets/USArrests.csv")
head(UA)
UA_1 <- UA %>%
group_by(x) %>%
mutate(sum(Murder, Assault, Rape)) %>%
rename(Violent_Crime = "sum(Murder, Assault, Rape)")
colnames(UA)
UA_1 <- UA %>%
group_by(X) %>%
mutate(sum(Murder, Assault, Rape)) %>%
rename(Violent_Crime = "sum(Murder, Assault, Rape)")
head(UA_1, 10)
state.77 <- as.data.frame(state.x77)
state.77 <- tibble::rownames_to_column(state.77, "X")
UA_1.2 <- left_join(UA_1, state.77, by = "X")
UA_1.2 <- cbind(UA_1.2,state.division)
UA_1.2 <- cbind(UA_1.2, state.region)
UA_1.2 <- UA_1.2 %>%
rename(State.Division = "state.division", State.Region = "state.region", State = "X", Murder = "Murder.x")
state.77 <- as.data.frame(state.x77)
state.77 <- tibble::rownames_to_column(state.77, "X")
UA_1.2 <- left_join(UA_1, state.77, by = "X")
UA_1.2 <- cbind(UA_1.2,state.division)
UA_1.2 <- cbind(UA_1.2, state.region)
UA_1.2 <- UA_1.2 %>%
rename(State.Division = "...15", State.Region = "...16", State = "X", Murder = "Murder.x")
head(UA_1.2, 10)
UA_avg <- UA_1.2 %>%
select(-c("State","State.Division", "State.Region"))
UA_avg <- colMeans(UA_avg)
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division")) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Violent_Crime))
UA_region
UA_avg <- UA_1.2 %>%
ungroup(State) %>%
select(-c("State","State.Division", "State.Region"))
UA_avg <- colMeans(UA_avg)
UA_avg
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division")) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Violent_Crime))
UA_region
UA_division <- UA_1.2 %>%
group_by(State.Division) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Violent_Crime))
UA_division <- UA_1.2 %>%
group_by(State.Division) %>%
select(-c("State","State.Region")) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Violent_Crime))
UA_division
UA_division <- UA_1.2 %>%
group_by(State.Division) %>%
select(-c("State","State.Region")) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Population))
UA_division
rm(list=ls())
# Normal Choroplath libs
library(tidyverse)
library(dplyr)
library(urbnmapr)
library(tmap)
library(sf)
library(stringr)
# Leaflet Choroplath libs
#dplyr
library(leaflet)
library(tigris)
#webscrapping
library(rvest)
data <- read.csv("state_2020.csv")
data_1 <- data %>%
select(State, Debt.Ratio..Total.Debts.Total.Assets) %>%
rename("Debt_Level" = "Debt.Ratio..Total.Debts.Total.Assets")
#Debt was recorded as a character, converted to numeric
data_1$Debt_Level <- str_remove_all(string = data_1$Debt_Level, pattern = "%")
data_1$Debt_Level <- as.numeric(data_1$Debt_Level)
# removing DC as it is a district
states_sf <- get_urbn_map("states", sf = TRUE)
states_sf <- states_sf %>%
filter(state_abbv != "DC")
# Debt levels by state
states_sf <- states_sf %>%
rename(State = "state_name")
state_debt <- left_join(data_1, states_sf, by = "State")
head(state_debt)
state_debt <- st_as_sf(state_debt)
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,250,300,350,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
# webscraping credit ratings of each state from wikipedia after I did my public service of updating their 2020 credit ratings since I have access to it
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores <- credit_scores %>%
select(State, '2020') %>%
filter(State != "Source:[2]") %>%
rename(Credit_Rating = "2020")
data_1 <- left_join(data_1, credit_scores, by = "State")
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating, "<br/>")
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 4) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,250,300,350,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(main.title = "State Debt Levels 2020 (%)", title = "State Debt Levels 2020 (%)", title.position = position)
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,250,300,350,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", title = "Debt Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,250,300,350,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", title = "Debt Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,300,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
?addPolygons
colors_bin <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level, n = 5)
# Any ideas how to make the scale stronger and brighter
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons( fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons( fillColor = ~colors_bin(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
colors_bin <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level, n = 5)
# Any ideas how to make the scale stronger and brighter
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons( fillColor = ~colors_bin(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons( stroke = FALSE, fillColor = ~colors_bin(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons(fillColor = ~colors_bin(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors_bin,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
?addPolygons
colors_bin <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level, n = 5)
# Any ideas how to make the scale stronger and brighter
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons(fillColor = ~colors_bin(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors_bin,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
rm(list=ls())
# Normal Choroplath libs
library(tidyverse)
library(dplyr)
library(urbnmapr)
library(tmap)
library(sf)
library(stringr)
# Leaflet Choroplath libs
#dplyr
library(leaflet)
library(tigris)
#webscrapping
library(rvest)
data <- read.csv("state_2020.csv")
data_1 <- data %>%
select(State, Debt.Ratio..Total.Debts.Total.Assets) %>%
rename("Debt_Level" = "Debt.Ratio..Total.Debts.Total.Assets")
#Debt was recorded as a character, converted to numeric
data_1$Debt_Level <- str_remove_all(string = data_1$Debt_Level, pattern = "%")
data_1$Debt_Level <- as.numeric(data_1$Debt_Level)
# removing DC as it is a district
states_sf <- get_urbn_map("states", sf = TRUE)
states_sf <- states_sf %>%
filter(state_abbv != "DC")
states_sf <- states_sf %>%
rename(State = "state_name")
state_debt <- left_join(data_1, states_sf, by = "State")
head(state_debt)
state_debt <- st_as_sf(state_debt)
position <- c("center", "top")
tm_shape(state_debt) +
tm_polygons(col = "Debt_Level", title = "Debt Level", palette = "Purples", breaks = c(0,25,50,75, 100, 150,200,300,400, 500)) +
tm_text(text = "state_abbv", size = .75, remove.overlap = TRUE) +
tm_legend(scale = .80) +
tm_layout(title = "State Debt Levels 2020 (%)", title.position = position)
# webscraping credit ratings of each state from wikipedia
credit <- read_html("https://en.wikipedia.org/wiki/List_of_U.S._states_by_credit_rating")
credit_scores <- credit %>%
html_nodes("table") %>%
.[[3]] %>%
html_table(fill = TRUE)
credit_scores <- credit_scores %>%
select(State, '2020') %>%
filter(State != "Source:[2]") %>%
rename(Credit_Rating = "2020")
data_1 <- left_join(data_1, credit_scores, by = "State")
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating, "<br/>")
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
# Any ideas how to make the scale stronger and brighter
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons(fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
leaflet_map <- states(cb = TRUE)
# Getting rid of US Territories
ter <- list("VI", "DC", "MP", "GU", "AS", "PR")
leaflet_map <- leaflet_map %>%
filter(!STUSPS %in% ter) %>%
rename(State = "NAME")
leaflet_debt <- left_join(data_1, leaflet_map, by = "State")
leaflet_debt <- st_as_sf(leaflet_debt)
content <- paste("State:", leaflet_debt$State,  "<br/>",
"Debt Level:", leaflet_debt$Debt_Level, "<br/>",
"Credit Rating:", leaflet_debt$Credit_Rating, "<br/>")
colors <- colorNumeric("Purples", domain = leaflet_debt$Debt_Level)
# Any ideas how to make the scale stronger and brighter
leaflet(leaflet_debt) %>%
addProviderTiles("Stamen.Toner") %>%
setView( lng = -95.71289, lat = 37.09024, zoom = 3) %>%
addPolygons(fillColor = ~colors(leaflet_debt$Debt_Level),
fillOpacity = 4,
popup = ~content,
label = leaflet_debt$State) %>%
addLegend(pal = colors,
values = leaflet_debt$Debt_Level,
position = "bottomright",
title = "Debt Level (%)")
rm(list=ls())
library(dplyr)
library (rvest)
web <- read_html("http://vincentarelbundock.github.io/Rdatasets/datasets.html")
web %>%
html_nodes("*") %>%
html_name() %>%
unique()
table <- web %>%
html_nodes ("table")
table_1 <- web %>%
html_nodes("table") %>%
.[[2]] %>%
html_table(fill = TRUE)
table_df <- as.data.frame(table_1) %>%
select("Package", "Item", "Title", "Rows", "Cols")
head(table_df, 5)
link <- "https://vincentarelbundock.github.io/Rdatasets/csv"
.csv <- ".csv"
check <- paste(link, table_df$Package, table_df$Item, sep = "/")
CSV_Links <-paste(check, .csv, sep = "")
table_df <- table_df %>%
mutate(CSV_Links)
head(table_df, 5)
title <- table_df %>%
filter(Title == "Violent Crime Rates by US State")
title
UA <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/datasets/USArrests.csv")
head(UA)
UA_1 <- UA %>%
group_by(X) %>%
mutate(sum(Murder, Assault, Rape)) %>%
rename(Violent_Crime = "sum(Murder, Assault, Rape)")
head(UA_1, 10)
state.77 <- as.data.frame(state.x77)
state.77 <- tibble::rownames_to_column(state.77, "X")
UA_1.2 <- left_join(UA_1, state.77, by = "X")
UA_1.2 <- cbind(UA_1.2,state.division)
UA_1.2 <- cbind(UA_1.2, state.region)
UA_1.2 <- UA_1.2 %>%
rename(State.Division = "...15", State.Region = "...16", State = "X", Murder = "Murder.x")
head(UA_1.2, 10)
UA_avg <- UA_1.2 %>%
ungroup(State) %>%
select(-c("State","State.Division", "State.Region"))
UA_avg <- colMeans(UA_avg)
UA_avg
UA_region <- UA_1.2 %>%
group_by(State.Region) %>%
select(-c("State","State.Division")) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Violent_Crime))
UA_region
UA_division <- UA_1.2 %>%
group_by(State.Division) %>%
select(-c("State","State.Region")) %>%
summarise_each(funs(mean)) %>%
arrange(desc(Population))
UA_division
library(dplyr)
setwd("~/Group_K_Gastronaut/Luke_US_Graphs")
data <- read.csv("debt_gdp.csv")
head(data)
library(ggplot2)
head(data)
data <- data %>%
rename(Debt/GDP(%))
head(data)
data <- data %>%
rename(Debt/GDP(%) = "GFDEGDQ188S")
data <- data %>%
rename("Debt/GDP(%)" = "GFDEGDQ188S")
head(data)
ggplot(data = data, x = DATE, y = Debt/GDP(%)) +
ggplot(data = data, x = DATE, y = "Debt/GDP(%)") +
geom_line()
data <- read.csv("debt_gdp.csv")
data <- data %>%
rename(Debt/GDP = "GFDEGDQ188S")
data <- data %>%
rename(Debt-GDP = "GFDEGDQ188S")
data <- read.csv("debt_gdp.csv")
data <- data %>%
rename(Debt-GDP = "GFDEGDQ188S")
data <- read.csv("debt_gdp.csv")
data <- data %>%
rename(Debt_GDP = "GFDEGDQ188S")
ggplot(data = data, x = DATE, y = Debt_GDP) +
geom_line()
ggplot(data = data) +
geom_line( x = DATE, y = Debt_GDP))
ggplot(data = data) +
geom_line( x = DATE, y = Debt_GDP)
colnames(data)
data <- read.csv("debt_gdp.csv")
data <- data %>%
rename(Debt_GDP = "GFDEGDQ188S")
colnames(data)
ggplot(data = data) +
geom_line( x = DATE, y = Debt_GDP)
ggplot(data = data) +
geom_line(aes( x = DATE, y = Debt_GDP))
